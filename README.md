# mattermost-custom-webhook-plugin

В данном репозитории содержится темплейт простого плагина для Mattermost. Данный плагин добавляет одну кастомную команду в mm. При использовании неё отправляется POST запрос на адрес, указанный в `webhookUrl` в `command.go`. В запросе содержится следующая информация:
```
{
		"root_id": root_id,   // root id треда, внутри которого отправлено сообщение с командой
		"raw_text": raw_text, // текст сообщения с командой без самой командый внутри
}
```
*Когда-нибудь мы обязательно добавим побольше параметров в запрос, чтобы повторять параметры из обычных исходящих вебхуков мм и расширять их, но пока так.*

После успешного ответа на запрос, отправленный на `webhookUrl`, команда отправляет пост от лица пользователя, использовавшего команду, в тред, где она была вызвана, с текстом ответа на запрос.

**Как использовать шаблон:**
1. Клонируем репозиторий
2. Меняем имя плагина в `plugin.json`
3. Устанавливаем и настраиваем GO
4. Изменяем плагин под свои нужды (вам понадобится файл `command.go`, в нём определена логика поведения команды и её параметры)
5. Открываем терминал и переходим в папку плагина
6. Настраиваем переменные окружения для компиляции `$env:GOOS = "linux"; $env:GOARCH= "amd64";`
7. Компилируем файл `go build -o plugin.exe`
8. Переносим `plugin.json` и `plugin.exe` в папку с именем нашего плагина в `/mattermost/server/plugins` или собираем архив с нашим файлом и загружаем его в Mattermost через системную консоль администратора (для создания архива используем команду `tar -czvf plugin.tar.gz plugin.exe plugin.json`)
9. В системной консоли активируем плагин
